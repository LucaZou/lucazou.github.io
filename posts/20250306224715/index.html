<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en-us">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Anomaly Detection App V1.7 - Luca&#39;s Blog</title><meta name="author" content="LucaZou">
<meta name="description" content=" V1.7 增加报告模块
"><meta name="keywords" content='PyQt, 异常检测, 计算机视觉'>
  <meta itemprop="name" content="Anomaly Detection App V1.7">
  <meta itemprop="description" content="V1.7 增加报告模块">
  <meta itemprop="datePublished" content="2025-03-06T22:47:15+08:00">
  <meta itemprop="dateModified" content="2025-03-06T22:47:15+08:00">
  <meta itemprop="wordCount" content="465">
  <meta itemprop="keywords" content="PyQt,异常检测,计算机视觉"><meta property="og:url" content="https://lucazou.github.io/posts/20250306224715/">
  <meta property="og:site_name" content="Luca&#39;s Blog">
  <meta property="og:title" content="Anomaly Detection App V1.7">
  <meta property="og:description" content="V1.7 增加报告模块">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-06T22:47:15+08:00">
    <meta property="article:modified_time" content="2025-03-06T22:47:15+08:00">
    <meta property="article:tag" content="PyQt">
    <meta property="article:tag" content="异常检测">
    <meta property="article:tag" content="计算机视觉">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Anomaly Detection App V1.7">
  <meta name="twitter:description" content="V1.7 增加报告模块">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://lucazou.github.io/posts/20250306224715/" title="Anomaly Detection App V1.7 - Luca&#39;s Blog" /><link rel="prev" type="text/html" href="https://lucazou.github.io/posts/20250304154607/" title="Anomaly Detection App V1.5" /><link rel="next" type="text/html" href="https://lucazou.github.io/posts/20250307182231/" title="【Pepper机器人管家（一）】项目构建" /><link rel="alternate" type="text/markdown" href="https://lucazou.github.io/posts/20250306224715/index.md" title="Anomaly Detection App V1.7 - Luca's Blog"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Anomaly Detection App V1.7",
    "inLanguage": "en-us",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/lucazou.github.io\/posts\/20250306224715\/"
    },"genre": "posts","keywords": "PyQt, 异常检测, 计算机视觉","wordcount":  465 ,
    "url": "https:\/\/lucazou.github.io\/posts\/20250306224715\/","datePublished": "2025-03-06T22:47:15+08:00","dateModified": "2025-03-06T22:47:15+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "LucaZou"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Luca&#39;s Blog"><span class="header-title-text">Luca&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Luca&#39;s Blog"><span class="header-title-text">Luca&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="转载" class="icon-repost"><i class="fa-solid fa-share fa-fw" aria-hidden="true"></i></span><span>Anomaly Detection App V1.7</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/LucaZou" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img class="avatar" src='https://www.gravatar.com/avatar/9f5a1ad7fad3a0db11b1adc11a98c085?s=32&d=' alt="LucaZou" height="16" width="16">&nbsp;LucaZou</a></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/" class="post-category" title="分类 - 项目文档"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 项目文档</a></span></div><div class="post-meta-line"><span title="发布于 2025-03-06 22:47:15"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-03-06">2025-03-06</time></span>&nbsp;<span title="465 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 500 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 3 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#项目概述">项目概述</a>
      <ul>
        <li><a href="#示例图">示例图</a></li>
        <li><a href="#主要功能">主要功能</a></li>
        <li><a href="#技术栈">技术栈</a></li>
      </ul>
    </li>
    <li><a href="#安装与运行">安装与运行</a>
      <ul>
        <li><a href="#环境要求">环境要求</a></li>
        <li><a href="#依赖安装">依赖安装</a></li>
        <li><a href="#项目文件">项目文件</a></li>
        <li><a href="#配置">配置</a></li>
        <li><a href="#运行">运行</a></li>
      </ul>
    </li>
    <li><a href="#代码结构与模块说明">代码结构与模块说明</a>
      <ul>
        <li><a href="#文件结构">文件结构</a></li>
        <li><a href="#核心类与功能">核心类与功能</a></li>
      </ul>
    </li>
    <li><a href="#使用说明">使用说明</a>
      <ul>
        <li><a href="#界面布局">界面布局</a></li>
        <li><a href="#操作流程">操作流程</a></li>
        <li><a href="#输出结果">输出结果</a></li>
      </ul>
    </li>
    <li><a href="#维护与扩展">维护与扩展</a>
      <ul>
        <li><a href="#常见问题排查">常见问题排查</a></li>
        <li><a href="#优化建议">优化建议</a></li>
        <li><a href="#代码维护">代码维护</a></li>
      </ul>
    </li>
    <li><a href="#版本信息">版本信息</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><blockquote>
<p>V1.7 增加报告模块</p></blockquote>
<h2 id="anomaly-detection-app-文档" class="heading-element"><span>Anomaly Detection App 文档</span>
  <a href="#anomaly-detection-app-%e6%96%87%e6%a1%a3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h2 id="项目概述" class="heading-element"><span>项目概述</span>
  <a href="#%e9%a1%b9%e7%9b%ae%e6%a6%82%e8%bf%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong>Anomaly Detection App</strong> 是一个基于 Python 和 PyQt5 的桌面应用程序，利用深度学习模型（如 Wide ResNet50 和 SimpleNet）进行图像异常检测。它支持单张和批量图片处理，提供直观的用户界面，用户可以选择模型、调整异常阈值、查看检测结果、分析报告并管理检测历史。应用通过多线程、GPU 加速和动态内存管理优化了性能，适用于工业检测、质量控制或其他需要图像异常分析的场景。</p>
<h3 id="示例图" class="heading-element"><span>示例图</span>
  <a href="#%e7%a4%ba%e4%be%8b%e5%9b%be" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>主界面</strong></li>
</ul>
<p><img loading="lazy" src='https://img-1313049298.cos.ap-shanghai.myqcloud.com/note-img/202503062246749.png' alt="image.png"></p>
<ul>
<li><strong>单张检测</strong></li>
</ul>
<p><img loading="lazy" src='https://img-1313049298.cos.ap-shanghai.myqcloud.com/note-img/202503062246750.png' alt="image.png"></p>
<ul>
<li><strong>批量检测与报告</strong></li>
</ul>
<p><img loading="lazy" src='https://img-1313049298.cos.ap-shanghai.myqcloud.com/note-img/202503062246751.png' alt="image.png"></p>
<p><img loading="lazy" src='https://img-1313049298.cos.ap-shanghai.myqcloud.com/note-img/202503062246752.png' alt="image.png"></p>
<p><em>注：新版本增加了“Report”选项卡，显示统计和图表。</em></p>
<ul>
<li><strong>历史记录查看</strong></li>
</ul>
<p><img loading="lazy" src='https://img-1313049298.cos.ap-shanghai.myqcloud.com/note-img/202503062246753.png' alt="image.png"></p>
<h3 id="主要功能" class="heading-element"><span>主要功能</span>
  <a href="#%e4%b8%bb%e8%a6%81%e5%8a%9f%e8%83%bd" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>模型选择</strong>：通过“Select Model”菜单选择预定义模型（如“Metal Nut”或“Screw”），支持快捷键（如 Ctrl+1）。</li>
<li><strong>单张检测</strong>：检测单张图片，显示结果和异常信息，支持拖放操作。</li>
<li><strong>批量检测</strong>：处理文件夹中的多张图片，生成检测结果、缩略图和分析报告，支持拖放文件夹。</li>
<li><strong>结果导航</strong>：通过缩略图点击切换批量检测结果，鼠标悬停显示详细信息。</li>
<li><strong>报告生成</strong>：批量检测后生成统计报告（异常数量、得分分布等）和图表（直方图、箱线图），支持导出为 CSV 或 PDF。</li>
<li><strong>历史记录</strong>：保存每次检测的报告，支持查看和重新加载历史结果。</li>
<li><strong>动态阈值</strong>：通过左侧滑块实时调整异常检测阈值（默认范围 0.0-2.0，默认值 1.2）。</li>
<li><strong>性能优化</strong>：支持动态批次大小、GPU 加速、多线程预加载和磁盘缓存，减少内存占用和处理时间。</li>
<li><strong>日志记录</strong>：可折叠日志区显示操作和错误信息，保存至文件。</li>
<li><strong>拖放支持</strong>：支持拖放图片或文件夹触发检测。</li>
</ul>
<h3 id="技术栈" class="heading-element"><span>技术栈</span>
  <a href="#%e6%8a%80%e6%9c%af%e6%a0%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>编程语言</strong>：Python 3.8+</li>
<li><strong>GUI 框架</strong>：PyQt5</li>
<li><strong>深度学习</strong>：PyTorch, torchvision</li>
<li><strong>图像处理</strong>：Pillow, NumPy, Matplotlib</li>
<li><strong>数据分析</strong>：pandas, NumPy</li>
<li><strong>报告生成</strong>：reportlab（PDF 导出）</li>
<li><strong>其他</strong>：tqdm（进度条）、logging（日志）、ruamel.yaml（配置文件）、concurrent.futures（多线程）</li>
</ul>
<hr>
<h2 id="安装与运行" class="heading-element"><span>安装与运行</span>
  <a href="#%e5%ae%89%e8%a3%85%e4%b8%8e%e8%bf%90%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="环境要求" class="heading-element"><span>环境要求</span>
  <a href="#%e7%8e%af%e5%a2%83%e8%a6%81%e6%b1%82" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>操作系统</strong>：Windows、macOS 或 Linux（跨平台支持）</li>
<li><strong>Python</strong>：3.8 或更高版本</li>
<li><strong>硬件</strong>：支持 CUDA 的 GPU（可选，推荐至少 6 GiB 显存以处理批量检测）</li>
</ul>
<h3 id="依赖安装" class="heading-element"><span>依赖安装</span>
  <a href="#%e4%be%9d%e8%b5%96%e5%ae%89%e8%a3%85" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>安装所需库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install PyQt5 torch torchvision pillow numpy matplotlib tqdm ruamel.yaml pandas reportlab</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>torch</strong>：若需 GPU 支持，请根据硬件安装对应 CUDA 版本（参考 <a href="https://pytorch.org/"target="_blank" rel="external nofollow noopener noreferrer">PyTorch 官网</a>）。</li>
<li><strong>simplenet</strong>：从 <a href="https://github.com/DonaldRR/SimpleNet"target="_blank" rel="external nofollow noopener noreferrer">GitHub</a> 克隆并置于项目目录，或根据需求修改 <code>simplenet.py</code>。</li>
</ul>
<h3 id="项目文件" class="heading-element"><span>项目文件</span>
  <a href="#%e9%a1%b9%e7%9b%ae%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>下载项目代码并确保以下结构完整：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">anomaly_detection_app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">gui</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">image_processor</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">model_loader</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">simplenet</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">progress_dialog</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">report_generator</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">performance_monitor</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">logs</span><span class="o">/</span>              <span class="c1"># 日志保存目录（自动创建）</span>
</span></span><span class="line"><span class="cl"><span class="err">└──</span> <span class="n">output</span><span class="o">/</span>            <span class="c1"># 检测结果和报告保存目录（自动创建）</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="配置" class="heading-element"><span>配置</span>
  <a href="#%e9%85%8d%e7%bd%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>编辑 <code>config.yaml</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Anomaly Detection App 的配置文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">load_mode</span><span class="p">:</span><span class="w"> </span><span class="l">preload </span><span class="w"> </span><span class="c"># 可选：preload（预加载）或 ondemand（按需加载）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="m">1.2</span><span class="w">      </span><span class="c"># 默认阈值，范围 0.0-2.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">models</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Metal Nut</span><span class="p">:</span><span class="w"> </span><span class="l">models/mvtec_metal_nut/ckpt.pth </span><span class="w"> </span><span class="c"># 金属螺母检测模型</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Screw</span><span class="p">:</span><span class="w"> </span><span class="l">models/mvtec_screw/ckpt.pth         </span><span class="w"> </span><span class="c"># 螺丝检测模型</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preload</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">max_preload_threads</span><span class="p">:</span><span class="w"> </span><span class="m">8</span><span class="w">    </span><span class="c"># 预加载最大线程数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">preload_chunk_size</span><span class="p">:</span><span class="w"> </span><span class="m">100</span><span class="w">   </span><span class="c"># 预加载分片大小</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">use_disk_cache</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">      </span><span class="c"># 是否使用磁盘缓存</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">max_memory_mb</span><span class="p">:</span><span class="w"> </span><span class="m">2048</span><span class="w">       </span><span class="c"># 最大内存使用量（MB）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">batch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">max_batch_threads</span><span class="p">:</span><span class="w"> </span><span class="m">12</span><span class="w">     </span><span class="c"># 批量检测最大线程数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">max_batch_size</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">        </span><span class="c"># 最大批次大小</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>load_mode</strong>：<code>preload</code> 在启动时加载所有模型，<code>ondemand</code> 在选择时加载。</li>
<li><strong>threshold</strong>：初始异常阈值，可通过界面调整。</li>
<li><strong>models</strong>：模型名称和路径，路径需指向有效的 <code>.pth</code> 文件。</li>
<li><strong>preload/batch</strong>：性能优化参数，可根据硬件调整。</li>
</ul>
<h3 id="运行" class="heading-element"><span>运行</span>
  <a href="#%e8%bf%90%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>确保模型文件路径正确。</li>
<li>进入项目目录：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> anomaly_detection_app</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>执行：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python main.py</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<hr>
<h2 id="代码结构与模块说明" class="heading-element"><span>代码结构与模块说明</span>
  <a href="#%e4%bb%a3%e7%a0%81%e7%bb%93%e6%9e%84%e4%b8%8e%e6%a8%a1%e5%9d%97%e8%af%b4%e6%98%8e" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="文件结构" class="heading-element"><span>文件结构</span>
  <a href="#%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong><code>main.py</code></strong>：
<ul>
<li>程序入口，配置日志，加载 <code>config.yaml</code>，初始化设备和处理器，启动 GUI。</li>
</ul>
</li>
<li><strong><code>gui.py</code></strong>：
<ul>
<li>定义图形界面，包括工具栏、选项卡（图像视图和报告）、缩略图、阈值滑块、历史记录对话框和日志区。</li>
<li>处理用户交互（模型选择、检测、阈值调整、报告导出、历史查看）。</li>
</ul>
</li>
<li><strong><code>image_processor.py</code></strong>：
<ul>
<li>图像处理核心，支持单张和批量检测，管理模型缓存和性能优化。</li>
</ul>
</li>
<li><strong><code>model_loader.py</code></strong>：
<ul>
<li>模型加载逻辑，定义 <code>load_model</code> 函数。</li>
</ul>
</li>
<li><strong><code>simplenet.py</code></strong>：
<ul>
<li>SimpleNet 模型实现，用于异常检测和热图生成。</li>
</ul>
</li>
<li><strong><code>progress_dialog.py</code></strong>：
<ul>
<li>进度对话框，用于模型加载和批量检测进度显示。</li>
</ul>
</li>
<li><strong><code>report_generator.py</code></strong>：
<ul>
<li>报告生成模块，统计检测结果，生成图表并支持导出。</li>
</ul>
</li>
<li><strong><code>performance_monitor.py</code></strong>：
<ul>
<li>性能监控模块，记录内存、线程和 I/O 使用情况。</li>
</ul>
</li>
<li><strong><code>exceptions.py</code></strong>：
<ul>
<li>自定义异常类，用于错误处理。</li>
</ul>
</li>
<li><strong><code>config.yaml</code></strong>：
<ul>
<li>配置文件，存储模型列表、加载模式、阈值和性能参数。</li>
</ul>
</li>
</ul>
<h3 id="核心类与功能" class="heading-element"><span>核心类与功能</span>
  <a href="#%e6%a0%b8%e5%bf%83%e7%b1%bb%e4%b8%8e%e5%8a%9f%e8%83%bd" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>
<p><strong><code>MainWindow</code> (gui.py)</strong>：</p>
<ul>
<li><strong>属性</strong>：
<ul>
<li><code>processor</code>：图像处理器实例。</li>
<li><code>result_paths</code>：检测结果路径列表。</li>
<li><code>detection_infos</code>：检测信息列表。</li>
<li><code>current_index</code>：当前显示图片索引。</li>
<li><code>current_report</code>：当前报告数据。</li>
<li><code>threshold</code>：异常阈值。</li>
</ul>
</li>
<li><strong>方法</strong>：
<ul>
<li><code>select_model</code>：选择并加载模型。</li>
<li><code>detect_single</code> / <code>detect_batch</code>：触发单张或批量检测。</li>
<li><code>detect_single_drop</code> / <code>detect_batch_drop</code>：处理拖放检测。</li>
<li><code>update_report</code>：更新报告选项卡和图像视图。</li>
<li><code>export_report</code>：导出报告为 CSV 或 PDF。</li>
<li><code>open_history</code>：打开历史记录对话框。</li>
</ul>
</li>
<li><strong>界面元素</strong>：
<ul>
<li>工具栏（“Select Model”、“Detect”、“Options”）。</li>
<li>选项卡（“Image View”和“Report”）。</li>
<li>状态栏、缩略图、阈值滑块、日志区。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>ImageProcessor</code> (image_processor.py)</strong>：</p>
<ul>
<li><strong>属性</strong>：
<ul>
<li><code>model_cache</code>：已加载模型缓存。</li>
<li><code>current_model_name</code>：当前模型名称。</li>
<li><code>report_generator</code>：报告生成器实例。</li>
</ul>
</li>
<li><strong>方法</strong>：
<ul>
<li><code>set_model</code>：设置当前模型。</li>
<li><code>detect_single_image</code>：单张检测，返回路径和信息。</li>
<li><code>detect_batch_images</code>：批量检测，生成报告。</li>
</ul>
</li>
<li><strong>信号</strong>：
<ul>
<li><code>report_generated</code>：批量检测完成后发出报告数据。</li>
</ul>
</li>
<li><strong>优化</strong>：
<ul>
<li>动态批次大小（<code>BatchDetectWorker</code>）。</li>
<li>多线程预加载（<code>ImagePreloader</code>）。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>ReportGenerator</code> (report_generator.py)</strong>：</p>
<ul>
<li><strong>属性</strong>：
<ul>
<li><code>output_dir</code>：报告保存目录。</li>
<li><code>history_file</code>：历史记录文件路径。</li>
</ul>
</li>
<li><strong>方法</strong>：
<ul>
<li><code>generate_report</code>：生成统计信息和图表。</li>
<li><code>save_history</code>：保存检测报告到历史记录。</li>
<li><code>export_to_csv</code> / <code>export_to_pdf</code>：导出报告。</li>
</ul>
</li>
<li><strong>功能</strong>：
<ul>
<li>统计异常数量、得分分布和异常程度。</li>
<li>生成直方图和箱线图。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>HistoryDialog</code> (gui.py)</strong>：</p>
<ul>
<li><strong>功能</strong>：显示历史记录列表，支持双击或“OK”加载报告。</li>
<li><strong>方法</strong>：
<ul>
<li><code>load_history</code>：加载历史记录。</li>
<li><code>load_selected_report</code>：加载选中的报告。</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="使用说明" class="heading-element"><span>使用说明</span>
  <a href="#%e4%bd%bf%e7%94%a8%e8%af%b4%e6%98%8e" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="界面布局" class="heading-element"><span>界面布局</span>
  <a href="#%e7%95%8c%e9%9d%a2%e5%b8%83%e5%b1%80" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>工具栏</strong>：
<ul>
<li>“Select Model”：选择模型，支持快捷键。</li>
<li>“Detect”：下拉菜单，包含“Single Image”和“Batch Images”。</li>
<li>“Options”：包含“Settings”和“View History”。</li>
</ul>
</li>
<li><strong>状态栏</strong>：显示“Model: [模型名] | Image: [图片名] | GPU Memory: [显存使用]”。</li>
<li><strong>左侧区域</strong>：
<ul>
<li>“Anomaly Threshold”：滑块调节阈值，实时更新。</li>
<li>“检测信息”：显示异常得分和判断。</li>
</ul>
</li>
<li><strong>右侧区域</strong>：
<ul>
<li><strong>选项卡</strong>：
<ul>
<li>“Image View”：显示检测结果（原图+热图）和缩略图。</li>
<li>“Report”：显示统计信息、图表和导出按钮。</li>
</ul>
</li>
<li><strong>缩略图列表</strong>：水平滚动，点击切换，悬停显示信息。</li>
<li><strong>日志区</strong>：可折叠，默认隐藏。</li>
</ul>
</li>
<li><strong>浮动进度条</strong>：检测或加载时显示进度。</li>
</ul>
<h3 id="操作流程" class="heading-element"><span>操作流程</span>
  <a href="#%e6%93%8d%e4%bd%9c%e6%b5%81%e7%a8%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li><strong>启动程序</strong>：
<ul>
<li><code>preload</code> 模式：加载所有模型，显示进度。</li>
<li><code>ondemand</code> 模式：显示“未选择模型”。</li>
</ul>
</li>
<li><strong>选择模型</strong>：
<ul>
<li>点击“Select Model”或按快捷键。</li>
<li>状态栏更新模型名。</li>
</ul>
</li>
<li><strong>单张检测</strong>：
<ul>
<li>点击“Detect -&gt; Single Image”或拖放图片。</li>
<li>显示结果和信息，缩略图显示单张。</li>
</ul>
</li>
<li><strong>批量检测</strong>：
<ul>
<li>点击“Detect -&gt; Batch Images”或拖放文件夹。</li>
<li>显示第一张结果，缩略图列出所有结果，报告选项卡显示统计和图表。</li>
</ul>
</li>
<li><strong>查看报告</strong>：
<ul>
<li>批量检测后自动切换到“Report”选项卡。</li>
<li>点击“Export Report”选择保存路径和格式（CSV/PDF）。</li>
</ul>
</li>
<li><strong>查看历史</strong>：
<ul>
<li>点击“Options -&gt; View History”。</li>
<li>选择记录，双击或点击“OK”加载。</li>
</ul>
</li>
<li><strong>调整阈值</strong>：
<ul>
<li>滑动阈值滑块，实时更新检测信息和 <code>config.yaml</code>。</li>
</ul>
</li>
<li><strong>查看日志</strong>：
<ul>
<li>点击“Show Log”展开日志区。</li>
</ul>
</li>
</ol>
<h3 id="输出结果" class="heading-element"><span>输出结果</span>
  <a href="#%e8%be%93%e5%87%ba%e7%bb%93%e6%9e%9c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>检测结果</strong>：<code>./output/[模型目录名]/detection_[输入文件名].png</code></li>
<li><strong>报告文件</strong>：
<ul>
<li>默认保存至 <code>./output/reports/</code>，可通过导出选择其他路径。</li>
<li>CSV：包含图像路径、得分和状态。</li>
<li>PDF：包含统计信息和图表。</li>
</ul>
</li>
<li><strong>历史记录</strong>：<code>./output/reports/detection_history.json</code></li>
</ul>
<hr>
<h2 id="维护与扩展" class="heading-element"><span>维护与扩展</span>
  <a href="#%e7%bb%b4%e6%8a%a4%e4%b8%8e%e6%89%a9%e5%b1%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="常见问题排查" class="heading-element"><span>常见问题排查</span>
  <a href="#%e5%b8%b8%e8%a7%81%e9%97%ae%e9%a2%98%e6%8e%92%e6%9f%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li><strong>导出报告失败（KeyError: &lsquo;image_paths&rsquo;）</strong>：
<ul>
<li>检查历史记录文件是否完整（需包含 <code>image_paths</code> 和 <code>scores</code>）。</li>
<li>重新运行批量检测生成新记录。</li>
</ul>
</li>
<li><strong>历史记录加载无效</strong>：
<ul>
<li>确保 <code>detection_history.json</code> 未损坏。</li>
<li>检查日志确认加载错误。</li>
</ul>
</li>
<li><strong>内存不足</strong>：
<ul>
<li>调整 <code>config.yaml</code> 中的 <code>max_batch_size</code> 或 <code>max_memory_mb</code>。</li>
<li>设置 <code>PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:128</code>。</li>
</ul>
</li>
<li><strong>拖放无效</strong>：
<ul>
<li>检查日志，确保拖放事件被识别。</li>
<li>以管理员权限运行程序（Windows）。</li>
</ul>
</li>
</ol>
<h3 id="优化建议" class="heading-element"><span>优化建议</span>
  <a href="#%e4%bc%98%e5%8c%96%e5%bb%ba%e8%ae%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li><strong>性能提升</strong>：
<ul>
<li>使用异步图表生成（<code>ProgressWorker</code>）。</li>
<li>优化 <code>SimpleNet.predict</code> 支持更大批量。</li>
</ul>
</li>
<li><strong>界面增强</strong>：
<ul>
<li>添加图表交互（放大、悬停提示，使用 PyQtGraph）。</li>
<li>支持历史记录筛选（按模型或日期）。</li>
</ul>
</li>
<li><strong>功能扩展</strong>：
<ul>
<li>添加异常原因分析（需模型支持）。</li>
<li>支持清理旧历史记录（按数量或时间）。</li>
</ul>
</li>
<li><strong>模型支持</strong>：
<ul>
<li>抽象模型接口，支持其他架构（如 YOLO）。</li>
</ul>
</li>
</ol>
<h3 id="代码维护" class="heading-element"><span>代码维护</span>
  <a href="#%e4%bb%a3%e7%a0%81%e7%bb%b4%e6%8a%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>模块化</strong>：GUI、处理、报告和模型逻辑分离。</li>
<li><strong>配置文件</strong>：支持动态调整参数（如异常程度阈值）。</li>
<li><strong>日志</strong>：详细记录操作和错误。</li>
<li><strong>测试</strong>：建议使用 <code>pytest</code> 测试检测、报告和历史功能。</li>
</ul>
<hr>
<h2 id="版本信息" class="heading-element"><span>版本信息</span>
  <a href="#%e7%89%88%e6%9c%ac%e4%bf%a1%e6%81%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>当前版本</strong>：v1.7</li>
<li><strong>更新日期</strong>：2025年3月6日</li>
<li><strong>作者</strong>：LucaZou</li>
<li><strong>更新记录</strong>：
<ul>
<li>v1.0：基本检测功能。</li>
<li>v1.1：多线程支持，界面优化。</li>
<li>v1.2：动态阈值、缩略图导航。</li>
<li>v1.4：YAML 配置、GPU 加速、内存优化。</li>
<li>v1.5：拖放支持、滑块阈值调整。</li>
<li>v1.7：报告模块、历史记录管理、导出功能。</li>
</ul>
</li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2025-03-06 22:47:15">更新于 2025-03-06&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/20250306224715/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 X" data-sharer="twitter" data-url="https://lucazou.github.io/posts/20250306224715/" data-title="Anomaly Detection App V1.7" data-hashtags="PyQt,异常检测,计算机视觉"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://lucazou.github.io/posts/20250306224715/" data-hashtag="PyQt"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://lucazou.github.io/posts/20250306224715/" data-title="Anomaly Detection App V1.7"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/pyqt/" class="post-tag" title="标签 - PyQt">PyQt</a><a href="/tags/%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B/" class="post-tag" title="标签 - 异常检测">异常检测</a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/" class="post-tag" title="标签 - 计算机视觉">计算机视觉</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/20250304154607/" class="post-nav-item" rel="prev" title="Anomaly Detection App V1.5"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Anomaly Detection App V1.5</a><a href="/posts/20250307182231/" class="post-nav-item" rel="next" title="【Pepper机器人管家（一）】项目构建">【Pepper机器人管家（一）】项目构建<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.144.2"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.17-8b402129"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/LucaZou"target="_blank" rel="external nofollow noopener noreferrer">LucaZou</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.17-8b402129"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-P7ZCZJP2K1', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-P7ZCZJP2K1" async></script></body>
</html>
